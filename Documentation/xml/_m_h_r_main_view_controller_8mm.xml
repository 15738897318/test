<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.7">
  <compounddef id="_m_h_r_main_view_controller_8mm" kind="file">
    <compoundname>MHRMainViewController.mm</compoundname>
    <includes refid="_m_h_r_main_view_controller_8hpp" local="yes">MHRMainViewController.hpp</includes>
    <includes refid="_u_i_image_c_v_mat_converter_8hpp" local="yes">UIImageCVMatConverter.hpp</includes>
    <includes refid="matlab_8h" local="yes">matlab.h</includes>
    <incdepgraph>
      <node id="879">
        <label>hb_counter_autocorr.h</label>
        <link refid="hb__counter__autocorr_8h"/>
        <childnode refid="869" relation="include">
        </childnode>
        <childnode refid="871" relation="include">
        </childnode>
        <childnode refid="876" relation="include">
        </childnode>
      </node>
      <node id="887">
        <label>UIImageCVMatConverter.hpp</label>
        <link refid="_u_i_image_c_v_mat_converter_8hpp"/>
        <childnode refid="851" relation="include">
        </childnode>
        <childnode refid="888" relation="include">
        </childnode>
      </node>
      <node id="882">
        <label>globals.h</label>
        <link refid="globals_8h"/>
        <childnode refid="883" relation="include">
        </childnode>
        <childnode refid="880" relation="include">
        </childnode>
      </node>
      <node id="858">
        <label>UIAlertView+Block.h</label>
        <link refid="_u_i_alert_view_09_block_8h"/>
        <childnode refid="851" relation="include">
        </childnode>
        <childnode refid="840" relation="include">
        </childnode>
        <childnode refid="859" relation="include">
        </childnode>
      </node>
      <node id="838">
        <label>MisfitHeartRate/MainView/MHRMainViewController.mm</label>
        <link refid="MHRMainViewController.mm"/>
        <childnode refid="839" relation="include">
        </childnode>
        <childnode refid="887" relation="include">
        </childnode>
        <childnode refid="871" relation="include">
        </childnode>
      </node>
      <node id="847">
        <label>opencv2/highgui/highgui_c.h</label>
      </node>
      <node id="871">
        <label>matlab.h</label>
        <link refid="matlab_8h"/>
        <childnode refid="872" relation="include">
        </childnode>
        <childnode refid="868" relation="include">
        </childnode>
      </node>
      <node id="849">
        <label>UIView+Position.h</label>
        <link refid="_u_i_view_09_position_8h"/>
        <childnode refid="840" relation="include">
        </childnode>
        <childnode refid="850" relation="include">
        </childnode>
      </node>
      <node id="852">
        <label>mach/mach.h</label>
      </node>
      <node id="844">
        <label>opencv2/highgui/ios.h</label>
      </node>
      <node id="880">
        <label>hr_signal_calc.h</label>
        <link refid="hr__signal__calc_8h"/>
        <childnode refid="875" relation="include">
        </childnode>
        <childnode refid="879" relation="include">
        </childnode>
        <childnode refid="881" relation="include">
        </childnode>
      </node>
      <node id="870">
        <label>ideal_bandpassing.h</label>
        <link refid="ideal__bandpassing_8h"/>
        <childnode refid="871" relation="include">
        </childnode>
      </node>
      <node id="841">
        <label>opencv2/core/core.hpp</label>
      </node>
      <node id="840">
        <label>UIKit/UIKit.h</label>
      </node>
      <node id="866">
        <label>build_Gdown_stack.h</label>
        <link refid="build___gdown__stack_8h"/>
        <childnode refid="867" relation="include">
        </childnode>
      </node>
      <node id="860">
        <label>config.h</label>
        <link refid="config_8h"/>
        <childnode refid="861" relation="include">
        </childnode>
        <childnode refid="862" relation="include">
        </childnode>
      </node>
      <node id="876">
        <label>hr_structures.h</label>
        <link refid="hr__structures_8h"/>
        <childnode refid="877" relation="include">
        </childnode>
        <childnode refid="878" relation="include">
        </childnode>
      </node>
      <node id="875">
        <label>hb_counter_pda.h</label>
        <link refid="hb__counter__pda_8h"/>
        <childnode refid="869" relation="include">
        </childnode>
        <childnode refid="871" relation="include">
        </childnode>
        <childnode refid="876" relation="include">
        </childnode>
      </node>
      <node id="857">
        <label>MHRResultViewController.hpp</label>
        <link refid="_m_h_r_result_view_controller_8hpp"/>
        <childnode refid="840" relation="include">
        </childnode>
        <childnode refid="858" relation="include">
        </childnode>
        <childnode refid="860" relation="include">
        </childnode>
      </node>
      <node id="845">
        <label>opencv2/highgui/cap_ios.h</label>
      </node>
      <node id="881">
        <label>hr_calculator.h</label>
        <link refid="hr__calculator_8h"/>
        <childnode refid="871" relation="include">
        </childnode>
      </node>
      <node id="869">
        <label>image.h</label>
        <link refid="image_8h"/>
        <childnode refid="868" relation="include">
        </childnode>
      </node>
      <node id="867">
        <label>files.h</label>
        <link refid="files_8h"/>
        <childnode refid="868" relation="include">
        </childnode>
        <childnode refid="869" relation="include">
        </childnode>
      </node>
      <node id="842">
        <label>opencv2/imgproc/types_c.h</label>
      </node>
      <node id="864">
        <label>run_algorithms.h</label>
        <link refid="run__algorithms_8h"/>
        <childnode refid="865" relation="include">
        </childnode>
        <childnode refid="873" relation="include">
        </childnode>
        <childnode refid="882" relation="include">
        </childnode>
      </node>
      <node id="874">
        <label>frames2signal.h</label>
        <link refid="frames2signal_8h"/>
        <childnode refid="871" relation="include">
        </childnode>
      </node>
      <node id="856">
        <label>CoreGraphics/CoreGraphics.h</label>
      </node>
      <node id="843">
        <label>opencv2/imgproc/imgproc.hpp</label>
      </node>
      <node id="885">
        <label>opencv2/objdetect/objdetect.hpp</label>
      </node>
      <node id="888">
        <label>opencv2/imgproc/imgproc_c.h</label>
      </node>
      <node id="859">
        <label>BlockAdditions.h</label>
        <link refid="_block_additions_8h"/>
      </node>
      <node id="877">
        <label>vector</label>
      </node>
      <node id="850">
        <label>MHRUtilities.h</label>
        <link refid="_m_h_r_utilities_8h"/>
        <childnode refid="851" relation="include">
        </childnode>
        <childnode refid="840" relation="include">
        </childnode>
        <childnode refid="852" relation="include">
        </childnode>
        <childnode refid="853" relation="include">
        </childnode>
        <childnode refid="854" relation="include">
        </childnode>
      </node>
      <node id="839">
        <label>MHRMainViewController.hpp</label>
        <link refid="_m_h_r_main_view_controller_8hpp"/>
        <childnode refid="840" relation="include">
        </childnode>
        <childnode refid="841" relation="include">
        </childnode>
        <childnode refid="842" relation="include">
        </childnode>
        <childnode refid="843" relation="include">
        </childnode>
        <childnode refid="844" relation="include">
        </childnode>
        <childnode refid="845" relation="include">
        </childnode>
        <childnode refid="846" relation="include">
        </childnode>
        <childnode refid="847" relation="include">
        </childnode>
        <childnode refid="848" relation="include">
        </childnode>
        <childnode refid="849" relation="include">
        </childnode>
        <childnode refid="855" relation="include">
        </childnode>
        <childnode refid="850" relation="include">
        </childnode>
        <childnode refid="857" relation="include">
        </childnode>
        <childnode refid="863" relation="include">
        </childnode>
        <childnode refid="864" relation="include">
        </childnode>
        <childnode refid="884" relation="include">
        </childnode>
        <childnode refid="882" relation="include">
        </childnode>
      </node>
      <node id="878">
        <label>utility</label>
      </node>
      <node id="853">
        <label>AVFoundation/AVFoundation.h</label>
      </node>
      <node id="848">
        <label>time.h</label>
      </node>
      <node id="865">
        <label>eulerian.h</label>
        <link refid="eulerian_8h"/>
        <childnode refid="866" relation="include">
        </childnode>
        <childnode refid="870" relation="include">
        </childnode>
      </node>
      <node id="846">
        <label>opencv2/highgui/highgui.hpp</label>
      </node>
      <node id="861">
        <label>face_params.h</label>
        <link refid="face__params_8h"/>
        <childnode refid="841" relation="include">
        </childnode>
        <childnode refid="842" relation="include">
        </childnode>
      </node>
      <node id="883">
        <label>iostream</label>
      </node>
      <node id="851">
        <label>Foundation/Foundation.h</label>
      </node>
      <node id="873">
        <label>temporal_mean_calc.h</label>
        <link refid="temporal__mean__calc_8h"/>
        <childnode refid="869" relation="include">
        </childnode>
        <childnode refid="874" relation="include">
        </childnode>
        <childnode refid="875" relation="include">
        </childnode>
        <childnode refid="879" relation="include">
        </childnode>
        <childnode refid="880" relation="include">
        </childnode>
      </node>
      <node id="868">
        <label>matrix.h</label>
        <link refid="matrix_8h"/>
        <childnode refid="860" relation="include">
        </childnode>
      </node>
      <node id="863">
        <label>MHRSettingsViewController.h</label>
        <link refid="_m_h_r_settings_view_controller_8h"/>
        <childnode refid="840" relation="include">
        </childnode>
      </node>
      <node id="872">
        <label>set</label>
      </node>
      <node id="862">
        <label>finger_params.h</label>
        <link refid="finger__params_8h"/>
        <childnode refid="841" relation="include">
        </childnode>
        <childnode refid="842" relation="include">
        </childnode>
      </node>
      <node id="886">
        <label>stdio.h</label>
      </node>
      <node id="854">
        <label>MHRAppDelegate.hpp</label>
        <link refid="_m_h_r_app_delegate_8hpp"/>
        <childnode refid="840" relation="include">
        </childnode>
      </node>
      <node id="855">
        <label>MBProgressHUD.h</label>
        <link refid="_m_b_progress_h_u_d_8h"/>
        <childnode refid="851" relation="include">
        </childnode>
        <childnode refid="840" relation="include">
        </childnode>
        <childnode refid="856" relation="include">
        </childnode>
      </node>
      <node id="884">
        <label>auto_start.hpp</label>
        <link refid="auto__start_8hpp"/>
        <childnode refid="885" relation="include">
        </childnode>
        <childnode refid="883" relation="include">
        </childnode>
        <childnode refid="886" relation="include">
        </childnode>
        <childnode refid="839" relation="include">
        </childnode>
      </node>
    </incdepgraph>
    <innerclass refid="category_m_h_r_main_view_controller_07_08" prot="public">MHRMainViewController()</innerclass>
      <sectiondef kind="var">
      <memberdef kind="variable" id="_m_h_r_main_view_controller_8mm_1a2cedb8dbc416f03a7e9d6e9533043773" prot="public" static="no" mutable="no">
        <type>const int</type>
        <definition>const int IOS6_Y_DELTA</definition>
        <argsstring></argsstring>
        <name>IOS6_Y_DELTA</name>
        <initializer>= 60</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/misfit/Desktop/Codes - Github-linked/videoHeartRate/MisfitHeartRate/MisfitHeartRate/MainView/MHRMainViewController.mm" line="13" column="1" bodyfile="/Users/misfit/Desktop/Codes - Github-linked/videoHeartRate/MisfitHeartRate/MisfitHeartRate/MainView/MHRMainViewController.mm" bodystart="13" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="_m_h_r_main_view_controller_8mm_1a964d7f0fc9e80567acdcdff8d0b68b4a" prot="public" static="no" mutable="no">
        <type>const int</type>
        <definition>const int CAMERA_WIDTH</definition>
        <argsstring></argsstring>
        <name>CAMERA_WIDTH</name>
        <initializer>= 352</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/misfit/Desktop/Codes - Github-linked/videoHeartRate/MisfitHeartRate/MisfitHeartRate/MainView/MHRMainViewController.mm" line="14" column="1" bodyfile="/Users/misfit/Desktop/Codes - Github-linked/videoHeartRate/MisfitHeartRate/MisfitHeartRate/MainView/MHRMainViewController.mm" bodystart="14" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="_m_h_r_main_view_controller_8mm_1abbbac9562c51eabfa14609a91464eb1c" prot="public" static="no" mutable="no">
        <type>const int</type>
        <definition>const int CAMERA_HEIGHT</definition>
        <argsstring></argsstring>
        <name>CAMERA_HEIGHT</name>
        <initializer>= 288</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/misfit/Desktop/Codes - Github-linked/videoHeartRate/MisfitHeartRate/MisfitHeartRate/MainView/MHRMainViewController.mm" line="15" column="1" bodyfile="/Users/misfit/Desktop/Codes - Github-linked/videoHeartRate/MisfitHeartRate/MisfitHeartRate/MainView/MHRMainViewController.mm" bodystart="15" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="_m_h_r_main_view_controller_8mm_1a86e681b82b6df52d2edfcd3361ef7ef2" prot="public" static="no" mutable="no">
        <type>const int</type>
        <definition>const int IMAGE_WIDTH</definition>
        <argsstring></argsstring>
        <name>IMAGE_WIDTH</name>
        <initializer>= 128</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/misfit/Desktop/Codes - Github-linked/videoHeartRate/MisfitHeartRate/MisfitHeartRate/MainView/MHRMainViewController.mm" line="16" column="1" bodyfile="/Users/misfit/Desktop/Codes - Github-linked/videoHeartRate/MisfitHeartRate/MisfitHeartRate/MainView/MHRMainViewController.mm" bodystart="16" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="_m_h_r_main_view_controller_8mm_1ac30c65321e99b04ebbdcdda7c2fac426" prot="public" static="no" mutable="no">
        <type>const int</type>
        <definition>const int IMAGE_HEIGHT</definition>
        <argsstring></argsstring>
        <name>IMAGE_HEIGHT</name>
        <initializer>= 128</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/misfit/Desktop/Codes - Github-linked/videoHeartRate/MisfitHeartRate/MisfitHeartRate/MainView/MHRMainViewController.mm" line="17" column="1" bodyfile="/Users/misfit/Desktop/Codes - Github-linked/videoHeartRate/MisfitHeartRate/MisfitHeartRate/MainView/MHRMainViewController.mm" bodystart="17" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="_m_h_r_main_view_controller_8mm_1a3f33c36bfbff665a75263b4578776a71" prot="public" static="no" mutable="no">
        <type>const int</type>
        <definition>const int WIDTH_PADDING</definition>
        <argsstring></argsstring>
        <name>WIDTH_PADDING</name>
        <initializer>= (<ref refid="_m_h_r_main_view_controller_8mm_1a964d7f0fc9e80567acdcdff8d0b68b4a" kindref="member">CAMERA_WIDTH</ref>-<ref refid="_m_h_r_main_view_controller_8mm_1a86e681b82b6df52d2edfcd3361ef7ef2" kindref="member">IMAGE_WIDTH</ref>)/2</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/misfit/Desktop/Codes - Github-linked/videoHeartRate/MisfitHeartRate/MisfitHeartRate/MainView/MHRMainViewController.mm" line="18" column="1" bodyfile="/Users/misfit/Desktop/Codes - Github-linked/videoHeartRate/MisfitHeartRate/MisfitHeartRate/MainView/MHRMainViewController.mm" bodystart="18" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="_m_h_r_main_view_controller_8mm_1a024d8577f09294f908fb4431519650d8" prot="public" static="no" mutable="no">
        <type>const int</type>
        <definition>const int HEIGHT_PADDING</definition>
        <argsstring></argsstring>
        <name>HEIGHT_PADDING</name>
        <initializer>= (<ref refid="_m_h_r_main_view_controller_8mm_1abbbac9562c51eabfa14609a91464eb1c" kindref="member">CAMERA_HEIGHT</ref>-<ref refid="_m_h_r_main_view_controller_8mm_1ac30c65321e99b04ebbdcdda7c2fac426" kindref="member">IMAGE_HEIGHT</ref>)/2</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/misfit/Desktop/Codes - Github-linked/videoHeartRate/MisfitHeartRate/MisfitHeartRate/MainView/MHRMainViewController.mm" line="19" column="1" bodyfile="/Users/misfit/Desktop/Codes - Github-linked/videoHeartRate/MisfitHeartRate/MisfitHeartRate/MainView/MHRMainViewController.mm" bodystart="19" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="_m_h_r_main_view_controller_8mm_1a80a347d4e2053fd19fef6fdb639887c3" prot="public" static="yes" mutable="no">
        <type>NSString *const</type>
        <definition>NSString* const FACE_MESSAGE</definition>
        <argsstring></argsstring>
        <name>FACE_MESSAGE</name>
        <initializer>= @&quot;Make sure your face fitted in the Aqua rectangle!&quot;</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/misfit/Desktop/Codes - Github-linked/videoHeartRate/MisfitHeartRate/MisfitHeartRate/MainView/MHRMainViewController.mm" line="20" column="1" bodyfile="/Users/misfit/Desktop/Codes - Github-linked/videoHeartRate/MisfitHeartRate/MisfitHeartRate/MainView/MHRMainViewController.mm" bodystart="20" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="_m_h_r_main_view_controller_8mm_1a6d21d4b2204cdfda10cc4c2ebcb93b2c" prot="public" static="yes" mutable="no">
        <type>NSString *const</type>
        <definition>NSString* const FINGER_MESSAGE</definition>
        <argsstring></argsstring>
        <name>FINGER_MESSAGE</name>
        <initializer>= @&quot;Completely cover the back-camera and the flash with your finger!&quot;</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/misfit/Desktop/Codes - Github-linked/videoHeartRate/MisfitHeartRate/MisfitHeartRate/MainView/MHRMainViewController.mm" line="21" column="1" bodyfile="/Users/misfit/Desktop/Codes - Github-linked/videoHeartRate/MisfitHeartRate/MisfitHeartRate/MainView/MHRMainViewController.mm" bodystart="21" bodyend="-1"/>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>MHRMainViewController.m</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>videoHeartRate</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>Created<sp/>by<sp/>Bao<sp/>Nguyen<sp/>on<sp/>6/23/14.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>Copyright<sp/>(c)<sp/>2014<sp/>misfit.<sp/>All<sp/>rights<sp/>reserved.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="preprocessor">#import<sp/>&quot;<ref refid="_m_h_r_main_view_controller_8hpp" kindref="compound">MHRMainViewController.hpp</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight><highlight class="preprocessor">#import<sp/>&quot;<ref refid="_u_i_image_c_v_mat_converter_8hpp" kindref="compound">UIImageCVMatConverter.hpp</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight><highlight class="preprocessor">#import<sp/>&quot;<ref refid="matlab_8h" kindref="compound">matlab.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight></codeline>
<codeline lineno="13" refid="_m_h_r_main_view_controller_8mm_1a2cedb8dbc416f03a7e9d6e9533043773" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="_m_h_r_main_view_controller_8mm_1a2cedb8dbc416f03a7e9d6e9533043773" kindref="member">IOS6_Y_DELTA</ref><sp/>=<sp/>60;</highlight></codeline>
<codeline lineno="14" refid="_m_h_r_main_view_controller_8mm_1a964d7f0fc9e80567acdcdff8d0b68b4a" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="_m_h_r_main_view_controller_8mm_1a964d7f0fc9e80567acdcdff8d0b68b4a" kindref="member">CAMERA_WIDTH</ref><sp/>=<sp/>352;</highlight></codeline>
<codeline lineno="15" refid="_m_h_r_main_view_controller_8mm_1abbbac9562c51eabfa14609a91464eb1c" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="_m_h_r_main_view_controller_8mm_1abbbac9562c51eabfa14609a91464eb1c" kindref="member">CAMERA_HEIGHT</ref><sp/>=<sp/>288;</highlight></codeline>
<codeline lineno="16" refid="_m_h_r_main_view_controller_8mm_1a86e681b82b6df52d2edfcd3361ef7ef2" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="_m_h_r_main_view_controller_8mm_1a86e681b82b6df52d2edfcd3361ef7ef2" kindref="member">IMAGE_WIDTH</ref><sp/>=<sp/>128;</highlight></codeline>
<codeline lineno="17" refid="_m_h_r_main_view_controller_8mm_1ac30c65321e99b04ebbdcdda7c2fac426" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="_m_h_r_main_view_controller_8mm_1ac30c65321e99b04ebbdcdda7c2fac426" kindref="member">IMAGE_HEIGHT</ref><sp/>=<sp/>128;</highlight></codeline>
<codeline lineno="18" refid="_m_h_r_main_view_controller_8mm_1a3f33c36bfbff665a75263b4578776a71" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="_m_h_r_main_view_controller_8mm_1a3f33c36bfbff665a75263b4578776a71" kindref="member">WIDTH_PADDING</ref><sp/>=<sp/>(<ref refid="_m_h_r_main_view_controller_8mm_1a964d7f0fc9e80567acdcdff8d0b68b4a" kindref="member">CAMERA_WIDTH</ref>-<ref refid="_m_h_r_main_view_controller_8mm_1a86e681b82b6df52d2edfcd3361ef7ef2" kindref="member">IMAGE_WIDTH</ref>)/2;</highlight></codeline>
<codeline lineno="19" refid="_m_h_r_main_view_controller_8mm_1a024d8577f09294f908fb4431519650d8" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="_m_h_r_main_view_controller_8mm_1a024d8577f09294f908fb4431519650d8" kindref="member">HEIGHT_PADDING</ref><sp/>=<sp/>(<ref refid="_m_h_r_main_view_controller_8mm_1abbbac9562c51eabfa14609a91464eb1c" kindref="member">CAMERA_HEIGHT</ref>-<ref refid="_m_h_r_main_view_controller_8mm_1ac30c65321e99b04ebbdcdda7c2fac426" kindref="member">IMAGE_HEIGHT</ref>)/2;</highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>NSString<sp/>*<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>FACE_MESSAGE<sp/>=<sp/></highlight><highlight class="stringliteral">@&quot;Make<sp/>sure<sp/>your<sp/>face<sp/>fitted<sp/>in<sp/>the<sp/>Aqua<sp/>rectangle!&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>NSString<sp/>*<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>FINGER_MESSAGE<sp/>=<sp/></highlight><highlight class="stringliteral">@&quot;Completely<sp/>cover<sp/>the<sp/>back-camera<sp/>and<sp/>the<sp/>flash<sp/>with<sp/>your<sp/>finger!&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight></codeline>
<codeline lineno="24" refid="category_m_h_r_main_view_controller_07_08" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">@interface<sp/></highlight><highlight class="normal"><ref refid="interface_m_h_r_main_view_controller" kindref="compound">MHRMainViewController</ref><sp/>()</highlight></codeline>
<codeline lineno="25"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="26" refid="category_m_h_r_main_view_controller_07_08_1a0b32e144ea6d386ce5180a75b7f1ac76" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BOOL<sp/><ref refid="category_m_h_r_main_view_controller_07_08_1a0b32e144ea6d386ce5180a75b7f1ac76" kindref="member">isCapturing</ref>;</highlight></codeline>
<codeline lineno="27" refid="category_m_h_r_main_view_controller_07_08_1a8ec78910220259631707236b9160c626" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cv::Rect<sp/>cropArea,<sp/><ref refid="category_m_h_r_main_view_controller_07_08_1a8ec78910220259631707236b9160c626" kindref="member">ROI_upper</ref>,<sp/>ROI_lower;</highlight></codeline>
<codeline lineno="28" refid="category_m_h_r_main_view_controller_07_08_1aee235ca60383f404b812a075eca55e75" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interface_m_h_r_result_view_controller" kindref="compound">MHRResultViewController</ref><sp/>*<ref refid="category_m_h_r_main_view_controller_07_08_1aee235ca60383f404b812a075eca55e75" kindref="member">resultView</ref>;</highlight></codeline>
<codeline lineno="29" refid="category_m_h_r_main_view_controller_07_08_1a8c4078159735c117ecbeb565b9c287e2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_m_h_r_1_1hr_result" kindref="compound">hrResult</ref><sp/><ref refid="category_m_h_r_main_view_controller_07_08_1a8c4078159735c117ecbeb565b9c287e2" kindref="member">currentResult</ref>;</highlight></codeline>
<codeline lineno="30" refid="category_m_h_r_main_view_controller_07_08_1a796178035a8c8f1b629b666076fe1ef3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="category_m_h_r_main_view_controller_07_08_1a796178035a8c8f1b629b666076fe1ef3" kindref="member">framesWithFace</ref>;<sp/></highlight><highlight class="comment">//<sp/>Count<sp/>the<sp/>number<sp/>of<sp/>frames<sp/>having<sp/>a<sp/>face<sp/>in<sp/>the<sp/>region<sp/>of<sp/>interest</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="31" refid="category_m_h_r_main_view_controller_07_08_1a7c19b115c59979a430b286b0ab7d57cc" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="category_m_h_r_main_view_controller_07_08_1a7c19b115c59979a430b286b0ab7d57cc" kindref="member">framesWithNoFace</ref>;<sp/></highlight><highlight class="comment">//<sp/>Count<sp/>the<sp/>number<sp/>of<sp/>frames<sp/>NOT<sp/>having<sp/>a<sp/>face<sp/>in<sp/>the<sp/>region<sp/>of<sp/>interest</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="32" refid="category_m_h_r_main_view_controller_07_08_1ad7e9d3339af1110426f965b7615b5988" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interface_m_b_progress_h_u_d" kindref="compound">MBProgressHUD</ref><sp/>*<ref refid="category_m_h_r_main_view_controller_07_08_1ad7e9d3339af1110426f965b7615b5988" kindref="member">progressHUD</ref>;</highlight></codeline>
<codeline lineno="33"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight></codeline>
<codeline lineno="35" refid="category_m_h_r_main_view_controller_07_08_1a82652cbbdc0ac312a50c591870b579c1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">@property</highlight><highlight class="normal"><sp/>(retain,<sp/>nonatomic)<sp/>CvVideoCamera<sp/>*videoCamera;</highlight></codeline>
<codeline lineno="36" refid="category_m_h_r_main_view_controller_07_08_1acf930d5712d9bba15886bab49c00f36c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">@property</highlight><highlight class="normal"><sp/>(strong,<sp/>nonatomic)<sp/>NSString<sp/>*outPath;</highlight></codeline>
<codeline lineno="37" refid="category_m_h_r_main_view_controller_07_08_1aff8ddd68733b8b626fc832ebf2390398" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">@property</highlight><highlight class="normal"><sp/>(assign,<sp/>nonatomic)<sp/>NSInteger<sp/>nFrames;</highlight></codeline>
<codeline lineno="38" refid="category_m_h_r_main_view_controller_07_08_1ac15f6b287a439206e9a1a8816248f635" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">@property</highlight><highlight class="normal"><sp/>(assign,<sp/>nonatomic)<sp/>NSInteger<sp/>recordTime;</highlight></codeline>
<codeline lineno="39" refid="category_m_h_r_main_view_controller_07_08_1a1f1639552968eeba13ed2b4575bea129" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">@property</highlight><highlight class="normal"><sp/>(strong,<sp/>nonatomic)<sp/>NSTimer<sp/>*recordTimer;</highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight></codeline>
<codeline lineno="41" refid="category_m_h_r_main_view_controller_07_08_1ad4a109ef255380e19bcda3c2efb2ce83" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">@property</highlight><highlight class="normal"><sp/>(weak,<sp/>nonatomic)<sp/>IBOutlet<sp/>UIImageView<sp/>*imageView;</highlight></codeline>
<codeline lineno="42" refid="category_m_h_r_main_view_controller_07_08_1a64545a3386e0d53f59af539582caafd4" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">@property</highlight><highlight class="normal"><sp/>(weak,<sp/>nonatomic)<sp/>IBOutlet<sp/>UISwitch<sp/>*cameraSwitch;</highlight></codeline>
<codeline lineno="43" refid="category_m_h_r_main_view_controller_07_08_1a2457cf5b05fac6f6cb9483997159f5f6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">@property</highlight><highlight class="normal"><sp/>(weak,<sp/>nonatomic)<sp/>IBOutlet<sp/>UILabel<sp/>*faceLabel;</highlight></codeline>
<codeline lineno="44" refid="category_m_h_r_main_view_controller_07_08_1a67cd700e56983a4a3a1e6da4569bafe9" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">@property</highlight><highlight class="normal"><sp/>(weak,<sp/>nonatomic)<sp/>IBOutlet<sp/>UILabel<sp/>*fingerLabel;</highlight></codeline>
<codeline lineno="45" refid="category_m_h_r_main_view_controller_07_08_1a1419b93d2152551aec5038ff468f3ff6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">@property</highlight><highlight class="normal"><sp/>(weak,<sp/>nonatomic)<sp/>IBOutlet<sp/>UILabel<sp/>*fingerSwitchLabel;</highlight></codeline>
<codeline lineno="46" refid="category_m_h_r_main_view_controller_07_08_1addd32f0cbd1a4d5bfe69a837b3505ed6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">@property</highlight><highlight class="normal"><sp/>(weak,<sp/>nonatomic)<sp/>IBOutlet<sp/>UILabel<sp/>*faceSwitchLabel;</highlight></codeline>
<codeline lineno="47" refid="category_m_h_r_main_view_controller_07_08_1a63bbbfafd497288fe3035250ab5d9fcb" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">@property</highlight><highlight class="normal"><sp/>(weak,<sp/>nonatomic)<sp/>IBOutlet<sp/>UILabel<sp/>*recordTimeLabel;</highlight></codeline>
<codeline lineno="48" refid="category_m_h_r_main_view_controller_07_08_1a98273435af4fbcd1e437f257bb9ced12" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">@property</highlight><highlight class="normal"><sp/>(strong,<sp/>nonatomic)<sp/>IBOutlet<sp/>UIBarButtonItem<sp/>*startButton;</highlight></codeline>
<codeline lineno="49" refid="category_m_h_r_main_view_controller_07_08_1a0e349ec3fa2cecae6592c8d9489dedfe" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">@property</highlight><highlight class="normal"><sp/>(strong,<sp/>nonatomic)<sp/>IBOutlet<sp/>UIBarButtonItem<sp/>*stopButton;</highlight></codeline>
<codeline lineno="50"><highlight class="normal"></highlight></codeline>
<codeline lineno="51"><highlight class="normal"></highlight><highlight class="keyword">@end</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="52"><highlight class="normal"></highlight></codeline>
<codeline lineno="53"><highlight class="normal"></highlight></codeline>
<codeline lineno="54"><highlight class="normal"></highlight><highlight class="keyword">@implementation<sp/></highlight><highlight class="normal"><ref refid="interface_m_h_r_main_view_controller" kindref="compound">MHRMainViewController</ref></highlight></codeline>
<codeline lineno="55"><highlight class="normal"></highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">@synthesize</highlight><highlight class="normal"><sp/>videoCamera<sp/>=<sp/>_videoCamera;</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">@synthesize</highlight><highlight class="normal"><sp/>cameraSwitch<sp/>=<sp/>_cameraSwitch;</highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">@synthesize</highlight><highlight class="normal"><sp/>outPath<sp/>=<sp/>_outPath;</highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">@synthesize</highlight><highlight class="normal"><sp/>nFrames<sp/>=<sp/>_nFrames;</highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">@synthesize</highlight><highlight class="normal"><sp/>recordTime<sp/>=<sp/>_recordTime;</highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">@synthesize</highlight><highlight class="normal"><sp/>recordTimer<sp/>=<sp/>_recordTimer;</highlight></codeline>
<codeline lineno="62"><highlight class="normal"></highlight></codeline>
<codeline lineno="63"><highlight class="normal"></highlight></codeline>
<codeline lineno="64"><highlight class="normal"></highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/>-<sp/>(id)initWithNibName:(NSString<sp/>*)nibNameOrNil<sp/>bundle:(NSBundle<sp/>*)nibBundleOrNil</highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">self</highlight><highlight class="normal"><sp/>=<sp/>[</highlight><highlight class="keyword">super</highlight><highlight class="normal"><sp/>initWithNibName:nibNameOrNil<sp/>bundle:nibBundleOrNil];</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">self</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Custom<sp/>initialization</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">self</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="73"><highlight class="normal"></highlight></codeline>
<codeline lineno="74"><highlight class="normal"></highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/>-<sp/>(void)viewDidLoad</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[</highlight><highlight class="keyword">super</highlight><highlight class="normal"><sp/>viewDidLoad];</highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespace_m_h_r_1a48555f02f08d43ff1f06f9413c86b5ca" kindref="member">setFaceParams</ref>();</highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>currentResult<sp/>=<sp/><ref refid="struct_m_h_r_1_1hr_result" kindref="compound">hrResult</ref>(55,<sp/>55);</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>isCapturing<sp/>=<sp/>NO;</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cropArea<sp/>=<sp/>cv::Rect(<ref refid="_m_h_r_main_view_controller_8mm_1a3f33c36bfbff665a75263b4578776a71" kindref="member">WIDTH_PADDING</ref>,<sp/><ref refid="_m_h_r_main_view_controller_8mm_1a024d8577f09294f908fb4431519650d8" kindref="member">HEIGHT_PADDING</ref>,<sp/><ref refid="_m_h_r_main_view_controller_8mm_1a86e681b82b6df52d2edfcd3361ef7ef2" kindref="member">IMAGE_WIDTH</ref>,<sp/><ref refid="_m_h_r_main_view_controller_8mm_1ac30c65321e99b04ebbdcdda7c2fac426" kindref="member">IMAGE_HEIGHT</ref>);</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Create<sp/>the<sp/>upper<sp/>&amp;<sp/>lower<sp/>bounds<sp/>for<sp/>the<sp/>face-detection<sp/>area</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>ROI_x;</highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>ROI_y;</highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>ROI_width;</highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>ROI_height;</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ROI_x<sp/>=<sp/>cropArea.x<sp/>-<sp/>(int)((double)cropArea.width<sp/>*<sp/>(<ref refid="namespace_m_h_r_1a4059754ac07ffb5b08e096059f347a82" kindref="member">_ROI_RATIO_UPPER</ref><sp/>-<sp/>1))<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ROI_y<sp/>=<sp/>cropArea.y<sp/>-<sp/>(int)((double)cropArea.height<sp/>*<sp/>(<ref refid="namespace_m_h_r_1a4059754ac07ffb5b08e096059f347a82" kindref="member">_ROI_RATIO_UPPER</ref><sp/>-<sp/>1))<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ROI_width<sp/>=<sp/>(int)((</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">)cropArea.width<sp/>*<sp/><ref refid="namespace_m_h_r_1a4059754ac07ffb5b08e096059f347a82" kindref="member">_ROI_RATIO_UPPER</ref>);</highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ROI_height<sp/>=<sp/>(int)((</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">)cropArea.height<sp/>*<sp/><ref refid="namespace_m_h_r_1a4059754ac07ffb5b08e096059f347a82" kindref="member">_ROI_RATIO_UPPER</ref>);</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ROI_upper<sp/>=<sp/>cv::Rect(ROI_x,<sp/>ROI_y,<sp/>ROI_width,<sp/>ROI_height);</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ROI_x<sp/>=<sp/>cropArea.x<sp/>-<sp/>(int)((double)cropArea.width<sp/>*<sp/>(<ref refid="namespace_m_h_r_1a8a54577ca92c7aa81cc87355a7160063" kindref="member">_ROI_RATIO_LOWER</ref><sp/>-<sp/>1))<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ROI_y<sp/>=<sp/>cropArea.y<sp/>-<sp/>(int)((double)cropArea.height<sp/>*<sp/>(<ref refid="namespace_m_h_r_1a8a54577ca92c7aa81cc87355a7160063" kindref="member">_ROI_RATIO_LOWER</ref><sp/>-<sp/>1))<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ROI_width<sp/>=<sp/>(int)((</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">)cropArea.width<sp/>*<sp/><ref refid="namespace_m_h_r_1a8a54577ca92c7aa81cc87355a7160063" kindref="member">_ROI_RATIO_LOWER</ref>);</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ROI_height<sp/>=<sp/>(int)((</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">)cropArea.height<sp/>*<sp/><ref refid="namespace_m_h_r_1a8a54577ca92c7aa81cc87355a7160063" kindref="member">_ROI_RATIO_LOWER</ref>);</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ROI_lower<sp/>=<sp/>cv::Rect(ROI_x,<sp/>ROI_y,<sp/>ROI_width,<sp/>ROI_height);</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>framesWithFace<sp/>=<sp/>framesWithNoFace<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_videoCamera<sp/>=<sp/>[[CvVideoCamera<sp/>alloc]<sp/>initWithParentView:self.imageView];</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_videoCamera.delegate<sp/>=<sp/></highlight><highlight class="keyword">self</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_videoCamera.defaultAVCaptureDevicePosition<sp/>=<sp/>AVCaptureDevicePositionFront;</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_videoCamera.defaultAVCaptureVideoOrientation<sp/>=<sp/>AVCaptureVideoOrientationLandscapeLeft;</highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_videoCamera.defaultAVCaptureSessionPreset<sp/>=<sp/>AVCaptureSessionPreset352x288;</highlight></codeline>
<codeline lineno="109"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_videoCamera.defaultAVCaptureSessionPreset<sp/>=<sp/>AVCaptureSessionPreset640x480;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_videoCamera.defaultFPS<sp/>=<sp/><ref refid="namespace_m_h_r_1a8c0f2199ebe2a27a2fc0cff1daa239ee" kindref="member">_frameRate</ref>;</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_videoCamera.rotateVideo<sp/>=<sp/>YES;</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_videoCamera.grayscaleMode<sp/>=<sp/>NO;</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[_videoCamera<sp/>start];</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>add<sp/>start<sp/>and<sp/>stop<sp/>button</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_startButton<sp/>=<sp/>[[UIBarButtonItem<sp/>alloc]<sp/>initWithTitle:@&quot;Start&quot;<sp/>style:UIBarButtonItemStylePlain<sp/>target:self<sp/>action:@selector(startButtonDidTap:)];</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_stopButton<sp/>=<sp/>[[UIBarButtonItem<sp/>alloc]<sp/>initWithTitle:@&quot;Stop&quot;<sp/>style:UIBarButtonItemStylePlain<sp/>target:self<sp/>action:@selector(stopButtonDidTap:)];</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">self</highlight><highlight class="normal">.navigationItem.leftBarButtonItem<sp/>=<sp/>_startButton;</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">self</highlight><highlight class="normal">.navigationItem.rightBarButtonItem<sp/>=<sp/>_stopButton;</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>draw<sp/>Aqua<sp/>rectangle</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[</highlight><highlight class="keyword">self</highlight><highlight class="normal"><sp/>drawFaceCaptureRect:@&quot;MHRCameraCaptureRect&quot;];</highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>update<sp/>Layout<sp/>(iOS6<sp/>vs<sp/>iOS7)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[</highlight><highlight class="keyword">self</highlight><highlight class="normal"><sp/>updateLayout];</highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="128"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>test_findpeak();</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="129"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[MHRTest<sp/>test_run_algorithm];</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="131"><highlight class="normal"></highlight></codeline>
<codeline lineno="132"><highlight class="normal"></highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/>-(void)viewDidDisappear:(BOOL)animated</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[</highlight><highlight class="keyword">super</highlight><highlight class="normal"><sp/>viewDidDisappear:animated];</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="137"><highlight class="normal"></highlight></codeline>
<codeline lineno="138"><highlight class="normal"></highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/>-(void)viewDidAppear:(BOOL)animated</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[</highlight><highlight class="keyword">super</highlight><highlight class="normal"><sp/>viewDidAppear:animated];</highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[</highlight><highlight class="keyword">self</highlight><highlight class="normal"><sp/>switchCamera:self];</highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="144"><highlight class="normal"></highlight></codeline>
<codeline lineno="145"><highlight class="normal"></highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/>-<sp/>(void)didReceiveMemoryWarning</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="148"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[super<sp/>didReceiveMmoryWarning];</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Dispose<sp/>of<sp/>any<sp/>resources<sp/>that<sp/>can<sp/>be<sp/>recreated.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="151"><highlight class="normal"></highlight></codeline>
<codeline lineno="152"><highlight class="normal"></highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/>-<sp/>(IBAction)startButtonDidTap:(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">)sender</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;_DEBUG_MODE<sp/>=<sp/>%d\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="namespace_m_h_r_1a2446951af16ca1137edb21f8e07019cb" kindref="member">_DEBUG_MODE</ref>);</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;_THREE_CHAN_MODE<sp/>=<sp/>%d\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="namespace_m_h_r_1a100c1e31c0fbc8c8b292064c1a8da006" kindref="member">_THREE_CHAN_MODE</ref>);</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(isCapturing)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>isCapturing<sp/>=<sp/>TRUE;</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>touchCount<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>touchCount<sp/>++;</highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NSLog(</highlight><highlight class="stringliteral">@&quot;%d&quot;</highlight><highlight class="normal">,touchCount);</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>create<sp/>new<sp/>directory<sp/>for<sp/>this<sp/>session</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NSArray<sp/>*paths<sp/>=<sp/>NSSearchPathForDirectoriesInDomains(NSDocumentationDirectory,<sp/>NSUserDomainMask,<sp/>YES);</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_outPath<sp/>=<sp/>[paths<sp/>objectAtIndex:0];</highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_outPath<sp/>=<sp/>[_outPath<sp/>substringToIndex:([_outPath<sp/>length]<sp/>-<sp/>[@&quot;Library/Documentation/&quot;<sp/>length]<sp/>+<sp/>1)];</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="namespace_m_h_r_1a2446951af16ca1137edb21f8e07019cb" kindref="member">_DEBUG_MODE</ref>)</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NSDateFormatter<sp/>*formater<sp/>=<sp/>[[NSDateFormatter<sp/>alloc]<sp/>init];</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>formater.dateFormat<sp/>=<sp/></highlight><highlight class="stringliteral">@&quot;yyyy-MM-dd-HH-mm-ss&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_outPath<sp/>=<sp/>[_outPath<sp/>stringByAppendingFormat:@&quot;Documents/%@/&quot;,</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[formater<sp/>stringFromDate:[NSDate<sp/>date]]];</highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_outPath<sp/>=<sp/>[_outPath<sp/>stringByAppendingFormat:@&quot;Documents/temp/&quot;];</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Clear<sp/>the<sp/>/temp<sp/>folder<sp/>in<sp/>advance,<sp/>before<sp/>populating<sp/>it<sp/>with<sp/>new<sp/>PNG<sp/>files</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NSFileManager<sp/>*fm<sp/>=<sp/>[NSFileManager<sp/>defaultManager];</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NSError<sp/>*error<sp/>=<sp/>nil;</highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BOOL<sp/>success<sp/>=<sp/>[fm<sp/>removeItemAtPath:_outPath<sp/>error:&amp;error];</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!success<sp/>||<sp/>error)<sp/>{</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>something<sp/>went<sp/>wrong</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[<ref refid="interface_m_h_r_utilities" kindref="compound">MHRUtilities</ref><sp/><ref refid="interface_m_h_r_utilities_1a85f3406abe6ae8911d4a8349996e1d6c" kindref="member">createDirectory</ref>:_outPath];</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespace_m_h_r_1a15d81a6b22ae7616409d6df6101690eb" kindref="member">_outputPath</ref><sp/>=<sp/>[_outPath<sp/>UTF8String]<sp/>+<sp/>String(&quot;/&quot;);</highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>isCapturing<sp/>=<sp/>YES;</highlight></codeline>
<codeline lineno="194"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.navigationItem.leftBarButtonItem.enabled<sp/>=<sp/>NO;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_startButton.enabled<sp/>=<sp/>NO;</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_cameraSwitch.enabled<sp/>=<sp/>NO;</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_nFrames<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_faceLabel.text<sp/>=<sp/>[NSString<sp/>stringWithFormat:@&quot;Recording....<sp/>(keep<sp/>at<sp/>least<sp/>%d<sp/>seconds)&quot;,<sp/>_minVidLength<sp/>];</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_recordTimer<sp/>=<sp/>[NSTimer<sp/>scheduledTimerWithTimeInterval:1.0</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>target:self</highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>selector:@selector(updateRecordTime:)</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>userInfo:nil</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>repeats:YES];</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="205"><highlight class="normal"></highlight></codeline>
<codeline lineno="206"><highlight class="normal"></highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/>-<sp/>(IBAction)stopButtonDidTap:(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">)sender</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!isCapturing)</highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>isCapturing<sp/>=<sp/>NO;</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_startButton.enabled<sp/>=<sp/>YES;</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_cameraSwitch.enabled<sp/>=<sp/>YES;</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[</highlight><highlight class="keyword">self</highlight><highlight class="normal"><sp/>drawFaceCaptureRect:@&quot;MHRWhiteColor&quot;];</highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>stop<sp/>camera<sp/>capturing</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[_videoCamera<sp/>stop];</highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>stop<sp/>timer</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[_recordTimer<sp/>invalidate];</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_recordTimer<sp/>=<sp/>nil;</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_recordTime<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[<ref refid="interface_m_h_r_utilities" kindref="compound">MHRUtilities</ref><sp/><ref refid="interface_m_h_r_utilities_1a4c2719ba1e46c5491a9868ab93dc8cfe" kindref="member">setTorchModeOn</ref>:NO];</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!_cameraSwitch.isOn)</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_fingerLabel.text<sp/>=<sp/></highlight><highlight class="stringliteral">@&quot;&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_faceLabel.text<sp/>=<sp/></highlight><highlight class="stringliteral">@&quot;Processing....&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>write<sp/>_nFrames<sp/>to<sp/>file</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FILE<sp/>*file<sp/>=<sp/>fopen(([_outPath<sp/>UTF8String]<sp/>+<sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal">(</highlight><highlight class="stringliteral">&quot;/input_frames.txt&quot;</highlight><highlight class="normal">)).c_str(),<sp/></highlight><highlight class="stringliteral">&quot;w&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fprintf(file,<sp/></highlight><highlight class="stringliteral">&quot;%d\n&quot;</highlight><highlight class="normal">,<sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)_nFrames);</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fclose(file);</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>heartRate<sp/>cal</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>__block<sp/><ref refid="struct_m_h_r_1_1hr_result" kindref="compound">hrResult</ref><sp/>result(-1,<sp/>-1);</highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Show<sp/>the<sp/>waiting<sp/>animation</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>progressHUD<sp/>=<sp/>[<ref refid="interface_m_b_progress_h_u_d" kindref="compound">MBProgressHUD</ref><sp/><ref refid="interface_m_b_progress_h_u_d_1a85d0c8c9647c47a289e7e7ea5d477c9a" kindref="member">showHUDAddedTo</ref>:self.view<sp/><ref refid="interface_m_b_progress_h_u_d_1a85d0c8c9647c47a289e7e7ea5d477c9a" kindref="member">animated</ref>:YES];</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>progressHUD.mode<sp/>=<sp/><ref refid="_m_b_progress_h_u_d_8h_1a553b6bab1602fa03257edde8491bb621a7d546c063ab8c0a2a5b590f8c2ca9ae1" kindref="member">MBProgressHUDModeIndeterminate</ref>;</highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Create<sp/>a<sp/>timer<sp/>event<sp/>that<sp/>regularly<sp/>calls<sp/>the<sp/>updateUI<sp/>function<sp/>to<sp/>display<sp/>the<sp/>HR<sp/>whilst<sp/>performing<sp/>calculations</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[NSTimer<sp/>scheduledTimerWithTimeInterval:3<sp/>target:self<sp/>selector:@selector(updateUI)<sp/>userInfo:nil<sp/>repeats:YES];</highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Initialise<sp/>the<sp/>result-storing<sp/>variables</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="globals_8cpp_1abb1219822989c459332111a5d38b5d72" kindref="member">hrGlobalResult</ref>.<ref refid="struct_m_h_r_1_1hr_result_1a369652948d5ff326dc1a822cbc0cc082" kindref="member">autocorr</ref><sp/>=<sp/><ref refid="globals_8cpp_1abb1219822989c459332111a5d38b5d72" kindref="member">hrGlobalResult</ref>.<ref refid="struct_m_h_r_1_1hr_result_1a7b5e354201327bd08c0ebded5c48367d" kindref="member">pda</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="globals_8cpp_1a0d559eafb7d80f04c3ac584cd2d6ca3f" kindref="member">hrOldGlobalResult</ref>.<ref refid="struct_m_h_r_1_1hr_result_1a369652948d5ff326dc1a822cbc0cc082" kindref="member">autocorr</ref><sp/>=<sp/><ref refid="globals_8cpp_1a0d559eafb7d80f04c3ac584cd2d6ca3f" kindref="member">hrOldGlobalResult</ref>.<ref refid="struct_m_h_r_1_1hr_result_1a7b5e354201327bd08c0ebded5c48367d" kindref="member">pda</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_LOW,<sp/>0),<sp/>^{</highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="namespace_m_h_r_1a2446951af16ca1137edb21f8e07019cb" kindref="member">_DEBUG_MODE</ref>)</highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;_nFrames<sp/>=<sp/>%ld,<sp/>_minVidLength<sp/>=<sp/>%d,<sp/>_frameRate<sp/>=<sp/>%d\n&quot;</highlight><highlight class="normal">,<sp/>(</highlight><highlight class="keywordtype">long</highlight><highlight class="normal">)_nFrames,<sp/><ref refid="namespace_m_h_r_1aced573ebf5ae641d5c3a58c9762462fb" kindref="member">_minVidLength</ref>,<sp/><ref refid="namespace_m_h_r_1a8c0f2199ebe2a27a2fc0cff1daa239ee" kindref="member">_frameRate</ref>);</highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="254"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[self<sp/>testRawVideo];</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(_nFrames<sp/>&gt;=<sp/><ref refid="namespace_m_h_r_1aced573ebf5ae641d5c3a58c9762462fb" kindref="member">_minVidLength</ref>*<ref refid="namespace_m_h_r_1a8c0f2199ebe2a27a2fc0cff1daa239ee" kindref="member">_frameRate</ref>)</highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/><ref refid="namespace_m_h_r_1a883e36fb9e762e11d5dcdb28b0b8e236" kindref="member">run_algorithms</ref>([_outPath<sp/>UTF8String],<sp/>[_outPath<sp/>UTF8String],<sp/>currentResult);</highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="258"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NSString<sp/>*resourcePath<sp/>=<sp/>[[NSBundle<sp/>mainBundle]<sp/>resourcePath];</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="259"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/>run_algorithms([resourcePath<sp/>UTF8String],<sp/>&quot;test1.mp4&quot;,<sp/>[_outPath<sp/>UTF8String]);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="260"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/>run_algorithms([resourcePath<sp/>UTF8String],<sp/>&quot;eulerianVid.avi&quot;,<sp/>[_outPath<sp/>UTF8String]);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dispatch_async(dispatch_get_main_queue(),<sp/>^{</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>show<sp/>result</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>resultView<sp/>=<sp/>[[<ref refid="interface_m_h_r_result_view_controller" kindref="compound">MHRResultViewController</ref><sp/>alloc]<sp/>init];</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>resultView.autocorrResult<sp/>=<sp/>result.autocorr;</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>resultView.pdaResult<sp/>=<sp/>result.pda;</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[</highlight><highlight class="keyword">self</highlight><highlight class="normal">.navigationController<sp/>pushViewController:resultView<sp/>animated:YES];</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>update<sp/>UI</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[<ref refid="interface_m_b_progress_h_u_d" kindref="compound">MBProgressHUD</ref><sp/><ref refid="interface_m_b_progress_h_u_d_1ab7a06aebc0d49b4fc963815ad424013f" kindref="member">hideHUDForView</ref>:self.view<sp/><ref refid="interface_m_b_progress_h_u_d_1ab7a06aebc0d49b4fc963815ad424013f" kindref="member">animated</ref>:YES];</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Reset<sp/>counters<sp/>of<sp/>mainView</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>framesWithFace<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>framesWithNoFace<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>isCapturing<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_recordTimeLabel.text<sp/>=<sp/></highlight><highlight class="stringliteral">@&quot;0&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>});</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>});</highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="281"><highlight class="normal"></highlight></codeline>
<codeline lineno="282"><highlight class="normal"></highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/>-<sp/>(void)updateUI</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>hr<sp/>=<sp/><ref refid="globals_8cpp_1abb1219822989c459332111a5d38b5d72" kindref="member">hrGlobalResult</ref>.<ref refid="struct_m_h_r_1_1hr_result_1a369652948d5ff326dc1a822cbc0cc082" kindref="member">autocorr</ref>;</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>If<sp/>the<sp/>HR<sp/>is<sp/>smaller<sp/>than<sp/>55,<sp/>then<sp/>show<sp/>a<sp/>randomised<sp/>number<sp/>based<sp/>on<sp/>55</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(hr<sp/>&lt;<sp/>55)</highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>hr<sp/>=<sp/>55<sp/>+<sp/>arc4random()<sp/>%<sp/>(10<sp/>+<sp/>5<sp/>+<sp/>1)<sp/>-<sp/>5;</highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>old_hr<sp/>=<sp/><ref refid="globals_8cpp_1a0d559eafb7d80f04c3ac584cd2d6ca3f" kindref="member">hrOldGlobalResult</ref>.<ref refid="struct_m_h_r_1_1hr_result_1a369652948d5ff326dc1a822cbc0cc082" kindref="member">autocorr</ref>;</highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>If<sp/>the<sp/>new<sp/>HR<sp/>is<sp/>same<sp/>as<sp/>the<sp/>old<sp/>HR,<sp/>then<sp/>show<sp/>a<sp/>randomised<sp/>number<sp/>based<sp/>on<sp/>the<sp/>old<sp/>HR</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(hr<sp/>==<sp/>old_hr)</highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>hr<sp/>=<sp/>old_hr<sp/>+<sp/>arc4random()<sp/>%<sp/>(6<sp/>+<sp/>3<sp/>+<sp/>1)<sp/>-<sp/>3;</highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="globals_8cpp_1a0d559eafb7d80f04c3ac584cd2d6ca3f" kindref="member">hrOldGlobalResult</ref>.<ref refid="struct_m_h_r_1_1hr_result_1a369652948d5ff326dc1a822cbc0cc082" kindref="member">autocorr</ref><sp/>=<sp/>hr;</highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>progressHUD.labelText<sp/>=<sp/>[NSString<sp/>stringWithFormat:@&quot;Calculating:<sp/>%d<sp/>BPM...&quot;,int(hr)];</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="306"><highlight class="normal"></highlight></codeline>
<codeline lineno="307"><highlight class="normal"></highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/>-<sp/>(IBAction)switchCamera:(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">)sender</highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(_cameraSwitch.isOn)</highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>front<sp/>camera<sp/>-<sp/>face<sp/>capturing</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[<ref refid="interface_m_h_r_utilities" kindref="compound">MHRUtilities</ref><sp/><ref refid="interface_m_h_r_utilities_1a4c2719ba1e46c5491a9868ab93dc8cfe" kindref="member">setTorchModeOn</ref>:NO];</highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_faceLabel.text<sp/>=<sp/>FACE_MESSAGE;</highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_fingerLabel.text<sp/>=<sp/></highlight><highlight class="stringliteral">@&quot;&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[</highlight><highlight class="keyword">self</highlight><highlight class="normal"><sp/>drawFaceCaptureRect:@&quot;MHRCameraCaptureRect&quot;];</highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[_videoCamera<sp/>stop];</highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Set<sp/>the<sp/>camera<sp/>to<sp/>show<sp/>camera<sp/>capture<sp/>onto<sp/>the<sp/>screen</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_videoCamera.ParentView<sp/>=<sp/></highlight><highlight class="keyword">self</highlight><highlight class="normal">.imageView;</highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_videoCamera.defaultAVCaptureDevicePosition<sp/>=<sp/>AVCaptureDevicePositionFront;</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[_videoCamera<sp/>start];</highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespace_m_h_r_1a48555f02f08d43ff1f06f9413c86b5ca" kindref="member">setFaceParams</ref>();</highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>back<sp/>camera<sp/>-<sp/>finger<sp/>capturing</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[<ref refid="interface_m_h_r_utilities" kindref="compound">MHRUtilities</ref><sp/><ref refid="interface_m_h_r_utilities_1a4c2719ba1e46c5491a9868ab93dc8cfe" kindref="member">setTorchModeOn</ref>:YES];</highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_faceLabel.text<sp/>=<sp/></highlight><highlight class="stringliteral">@&quot;&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_fingerLabel.text<sp/>=<sp/>FINGER_MESSAGE;</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[</highlight><highlight class="keyword">self</highlight><highlight class="normal"><sp/>drawFaceCaptureRect:@&quot;MHRWhiteColor&quot;];</highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[_videoCamera<sp/>stop];</highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Set<sp/>the<sp/>camera<sp/>to<sp/>hide<sp/>camera<sp/>capture<sp/>from<sp/>the<sp/>screen</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_videoCamera.ParentView<sp/>=<sp/>nil;</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_videoCamera.defaultAVCaptureDevicePosition<sp/>=<sp/>AVCaptureDevicePositionBack;</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[_videoCamera<sp/>start];</highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespace_m_h_r_1af336ca7b239bbe520636c7d147b913b5" kindref="member">setFingerParams</ref>();</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="341"><highlight class="normal"></highlight></codeline>
<codeline lineno="342"><highlight class="normal"></highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/>-<sp/>(void)updateRecordTime:(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">)sender</highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>++_recordTime;</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_recordTimeLabel.text<sp/>=<sp/>[NSString<sp/>stringWithFormat:@&quot;%i&quot;,<sp/>(int)_recordTime];</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(_recordTime<sp/>&gt;=<sp/><ref refid="namespace_m_h_r_1a0a7cdb59c1f1e8af6e6b61543c81724d" kindref="member">_maxVidLength</ref>)</highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[</highlight><highlight class="keyword">self</highlight><highlight class="normal"><sp/>stopButtonDidTap:self];</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="352"><highlight class="normal"></highlight></codeline>
<codeline lineno="353"><highlight class="normal"></highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/>-<sp/>(void)drawFaceCaptureRect:(NSString<sp/>*)colorKey</highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>x0<sp/>=<sp/></highlight><highlight class="keyword">self</highlight><highlight class="normal">.imageView.frameX;</highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>y0<sp/>=<sp/></highlight><highlight class="keyword">self</highlight><highlight class="normal">.imageView.frameY;</highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>x1<sp/>=<sp/>x0<sp/>+<sp/>self.imageView.frameWidth;</highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>y1<sp/>=<sp/>y0<sp/>+<sp/>self.imageView.frameHeight;</highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>dx<sp/>=<sp/>(<ref refid="_m_h_r_main_view_controller_8mm_1abbbac9562c51eabfa14609a91464eb1c" kindref="member">CAMERA_HEIGHT</ref><sp/>-<sp/><ref refid="_m_h_r_main_view_controller_8mm_1a86e681b82b6df52d2edfcd3361ef7ef2" kindref="member">IMAGE_WIDTH</ref>)/2;</highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>dy<sp/>=<sp/>(<ref refid="_m_h_r_main_view_controller_8mm_1a964d7f0fc9e80567acdcdff8d0b68b4a" kindref="member">CAMERA_WIDTH</ref><sp/>-<sp/><ref refid="_m_h_r_main_view_controller_8mm_1ac30c65321e99b04ebbdcdda7c2fac426" kindref="member">IMAGE_HEIGHT</ref>)/2;</highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>yDelta<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="_m_h_r_utilities_8h_1abc30dc0a00d4dcdb4e219a9c2e0aa5e4" kindref="member">SYSTEM_VERSION_LESS_THAN</ref>(</highlight><highlight class="stringliteral">@&quot;7.0&quot;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>yDelta<sp/>=<sp/>-<ref refid="_m_h_r_main_view_controller_8mm_1a2cedb8dbc416f03a7e9d6e9533043773" kindref="member">IOS6_Y_DELTA</ref>;</highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>horizontal<sp/>lines</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[</highlight><highlight class="keyword">self</highlight><highlight class="normal">.view.layer<sp/>addSublayer:[<ref refid="interface_m_h_r_utilities" kindref="compound">MHRUtilities</ref><sp/><ref refid="interface_m_h_r_utilities_1aced58e360114134fcc1982a6862fc523" kindref="member">newRectangleLayer</ref>:CGRectMake(x0<sp/>+<sp/>dx,<sp/>y0<sp/>+<sp/>dy<sp/>+<sp/>yDelta,<sp/>IMAGE_WIDTH,<sp/>5)<sp/><ref refid="interface_m_h_r_utilities_1aced58e360114134fcc1982a6862fc523" kindref="member">pListKey</ref>:colorKey]];</highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[</highlight><highlight class="keyword">self</highlight><highlight class="normal">.view.layer<sp/>addSublayer:[<ref refid="interface_m_h_r_utilities" kindref="compound">MHRUtilities</ref><sp/><ref refid="interface_m_h_r_utilities_1aced58e360114134fcc1982a6862fc523" kindref="member">newRectangleLayer</ref>:CGRectMake(x0<sp/>+<sp/>dx,<sp/>y1<sp/>-<sp/>dy<sp/>+<sp/>yDelta,<sp/>IMAGE_WIDTH,<sp/>5)<sp/><ref refid="interface_m_h_r_utilities_1aced58e360114134fcc1982a6862fc523" kindref="member">pListKey</ref>:colorKey]];</highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>vertical<sp/>lines</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[</highlight><highlight class="keyword">self</highlight><highlight class="normal">.view.layer<sp/>addSublayer:[<ref refid="interface_m_h_r_utilities" kindref="compound">MHRUtilities</ref><sp/><ref refid="interface_m_h_r_utilities_1aced58e360114134fcc1982a6862fc523" kindref="member">newRectangleLayer</ref>:CGRectMake(x0<sp/>+<sp/>dx,<sp/>y0<sp/>+<sp/>dy<sp/>+<sp/>yDelta,<sp/>5,<sp/>IMAGE_HEIGHT)<sp/><ref refid="interface_m_h_r_utilities_1aced58e360114134fcc1982a6862fc523" kindref="member">pListKey</ref>:colorKey]];</highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[</highlight><highlight class="keyword">self</highlight><highlight class="normal">.view.layer<sp/>addSublayer:[<ref refid="interface_m_h_r_utilities" kindref="compound">MHRUtilities</ref><sp/><ref refid="interface_m_h_r_utilities_1aced58e360114134fcc1982a6862fc523" kindref="member">newRectangleLayer</ref>:CGRectMake(x1<sp/>-<sp/>dx,<sp/>y0<sp/>+<sp/>dy<sp/>+<sp/>yDelta,<sp/>5,<sp/>IMAGE_HEIGHT+5)<sp/><ref refid="interface_m_h_r_utilities_1aced58e360114134fcc1982a6862fc523" kindref="member">pListKey</ref>:colorKey]];</highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="375"><highlight class="normal"></highlight></codeline>
<codeline lineno="376"><highlight class="normal"></highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/>-<sp/>(void)updateLayout</highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[_faceLabel<sp/>adjustFrameFormiOS7ToiOS6:IOS6_Y_DELTA];</highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[_fingerLabel<sp/>adjustFrameFormiOS7ToiOS6:IOS6_Y_DELTA];</highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[_fingerSwitchLabel<sp/>adjustFrameFormiOS7ToiOS6:IOS6_Y_DELTA];</highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[_faceSwitchLabel<sp/>adjustFrameFormiOS7ToiOS6:IOS6_Y_DELTA];</highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[_cameraSwitch<sp/>adjustFrameFormiOS7ToiOS6:IOS6_Y_DELTA];</highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[_recordTimeLabel<sp/>adjustFrameFormiOS7ToiOS6:IOS6_Y_DELTA];</highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="_m_h_r_utilities_8h_1abc30dc0a00d4dcdb4e219a9c2e0aa5e4" kindref="member">SYSTEM_VERSION_LESS_THAN</ref>(</highlight><highlight class="stringliteral">@&quot;7.0&quot;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_cameraSwitch.frameX<sp/>-=<sp/>20;</highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="390"><highlight class="normal"></highlight></codeline>
<codeline lineno="391"><highlight class="normal"></highlight></codeline>
<codeline lineno="392"><highlight class="normal"></highlight></codeline>
<codeline lineno="393"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/>#pragma<sp/>-<sp/>Protocol<sp/>CvVideoCameraDelegate</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/>-<sp/>(void)processImage:(Mat<sp/>&amp;)image</highlight></codeline>
<codeline lineno="395"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(isCapturing)</highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Mat<sp/>new_image<sp/>=<sp/>image(cropArea);</highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cvtColor(new_image,<sp/>new_image,<sp/>CV_BGRA2BGR);</highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>imwrite([_outPath<sp/>UTF8String]<sp/>+<sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal">(</highlight><highlight class="stringliteral">&quot;/input_frame[&quot;</highlight><highlight class="normal">)<sp/>+<sp/>to_string(_nFrames)<sp/>+<sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal">(</highlight><highlight class="stringliteral">&quot;].png&quot;</highlight><highlight class="normal">),<sp/>new_image);</highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>++_nFrames;</highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NSLog(</highlight><highlight class="stringliteral">@&quot;%ld&quot;</highlight><highlight class="normal">,(</highlight><highlight class="keywordtype">long</highlight><highlight class="normal">)_nFrames);</highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(_cameraSwitch.isOn)</highlight></codeline>
<codeline lineno="408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>Mat<sp/>tmp;</highlight></codeline>
<codeline lineno="410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>cnt<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cnt<sp/>=<sp/>(cnt<sp/>+<sp/>1)<sp/>%<sp/>3;</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(cnt)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tmp<sp/>=<sp/>image(ROI_upper).clone();</highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_LOW,<sp/>0),<sp/>^{</highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Cut<sp/>the<sp/>frame<sp/>down<sp/>to<sp/>the<sp/>upper<sp/>bound<sp/>of<sp/>ROI</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Mat<sp/>frame_ROI<sp/>=<sp/>tmp;</highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Rotate<sp/>the<sp/>frame<sp/>to<sp/>fit<sp/>the<sp/>orientation<sp/>preferred<sp/>by<sp/>the<sp/>detector</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>transpose(frame_ROI,<sp/>frame_ROI);</highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i=0;<sp/>i<sp/>&lt;<sp/>frame_ROI.rows<sp/>/<sp/>2;<sp/>++i)<sp/>for(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>j<sp/>=<sp/>0;<sp/>j<sp/>&lt;<sp/>frame_ROI.cols<sp/>*<sp/>4;<sp/>++j)</highlight></codeline>
<codeline lineno="423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>swap(frame_ROI.at&lt;</highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/>char&gt;(i,<sp/>j),<sp/>frame_ROI.at&lt;</highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/>char&gt;(frame_ROI.rows<sp/>-<sp/>i<sp/>-<sp/>1,<sp/>j));</highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>If<sp/>the<sp/>main<sp/>thread<sp/>is<sp/>already<sp/>running<sp/>the<sp/>capture<sp/>algo,<sp/>then<sp/>dont<sp/>do<sp/>the<sp/>face<sp/>detection</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(isCapturing)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Face<sp/>detection</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NSArray<sp/>*faces<sp/>=<sp/>[auto_start<sp/>detectFrontalFaces:&amp;frame_ROI];</highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>If<sp/>in<sp/>the<sp/>meantime,<sp/>the<sp/>main<sp/>thread<sp/>already<sp/>transitions<sp/>into<sp/>running<sp/>the<sp/>capture<sp/>algo,<sp/>then<sp/>dont<sp/>do<sp/>the<sp/>counting<sp/>increment</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(isCapturing)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>If<sp/>this<sp/>iteration<sp/>detects<sp/>valid<sp/>faces</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>-<sp/>Increment<sp/>the<sp/>framesWithFace<sp/>variable</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>assessmentResult<sp/>=<sp/>[auto_start<sp/>assessFaces:faces<sp/>withLowerBound:ROI_lower];</highlight></codeline>
<codeline lineno="437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>faces<sp/>=<sp/>nil;</highlight></codeline>
<codeline lineno="438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(assessmentResult<sp/>==<sp/>1)</highlight></codeline>
<codeline lineno="439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>framesWithFace<sp/>+=<sp/>1;</highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>framesWithNoFace<sp/>+=<sp/>1;</highlight></codeline>
<codeline lineno="445"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>If<sp/>a<sp/>face<sp/>is<sp/>not<sp/>detected<sp/>in<sp/>N<sp/>frames,<sp/>then<sp/>reset<sp/>the<sp/>face-detected<sp/>streak</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="448"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(framesWithNoFace<sp/>&gt;<sp/><ref refid="namespace_m_h_r_1adc786b108805d8d2ad944595ea2b7092" kindref="member">_THRESHOLD_NO_FACE_FRAMES_MIN</ref>)</highlight></codeline>
<codeline lineno="449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>framesWithFace<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="451"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>framesWithNoFace<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="452"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>If<sp/>a<sp/>face<sp/>is<sp/>detected<sp/>in<sp/>more<sp/>than<sp/>M<sp/>frames,<sp/>then<sp/>reset<sp/>the<sp/>no-face<sp/>streak</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(framesWithFace<sp/>&gt;<sp/><ref refid="namespace_m_h_r_1a90f94ddb83c7c54b9b0836586a51ad43" kindref="member">_THRESHOLD_FACE_FRAMES_MIN</ref>)</highlight></codeline>
<codeline lineno="456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="457"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>framesWithNoFace<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(framesWithFace<sp/>&gt;<sp/><ref refid="namespace_m_h_r_1a3c94a936257b6f3257fb7a7768ff4377" kindref="member">_THRESHOLD_FACE_FRAMES_FOR_START</ref>)</highlight></codeline>
<codeline lineno="461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="462"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>tap<sp/>the<sp/>startButton</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dispatch_async(dispatch_get_main_queue(),<sp/>^{</highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[</highlight><highlight class="keyword">self</highlight><highlight class="normal"><sp/>startButtonDidTap:self];</highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>});</highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>NSLog(@&quot;%d<sp/>%d<sp/>%d&quot;,assessmentResult,<sp/>framesWithFace,<sp/>framesWithNoFace);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>});</highlight></codeline>
<codeline lineno="470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="479"><highlight class="normal"></highlight></codeline>
<codeline lineno="480"><highlight class="normal"></highlight></codeline>
<codeline lineno="481"><highlight class="normal">-<sp/>(IBAction)settingsButtonDidTap:(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">)sender<sp/>{</highlight></codeline>
<codeline lineno="482"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="interface_m_h_r_settings_view_controller" kindref="compound">MHRSettingsViewController</ref><sp/>*settingsView<sp/>=<sp/>[[<ref refid="interface_m_h_r_settings_view_controller" kindref="compound">MHRSettingsViewController</ref><sp/>alloc]<sp/>init];</highlight></codeline>
<codeline lineno="483"><highlight class="normal"><sp/><sp/><sp/><sp/>settingsView.<ref refid="interface_m_h_r_settings_view_controller_1a44380e171f6d773f58dc158ff58d47aa" kindref="member">delegate</ref><sp/>=<sp/></highlight><highlight class="keyword">self</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="484"><highlight class="normal"><sp/><sp/><sp/><sp/>settingsView.<ref refid="interface_m_h_r_settings_view_controller_1abb8745a6f5f7529e69628d8f5f4f068e" kindref="member">debugModeOn</ref><sp/>=<sp/>(<ref refid="namespace_m_h_r_1a2446951af16ca1137edb21f8e07019cb" kindref="member">_DEBUG_MODE</ref><sp/>&gt;<sp/>0);</highlight></codeline>
<codeline lineno="485"><highlight class="normal"><sp/><sp/><sp/><sp/>settingsView.<ref refid="interface_m_h_r_settings_view_controller_1add55937fcb10a424e5f651d372b4b6a9" kindref="member">threeChanModeOn</ref><sp/>=<sp/>(<ref refid="namespace_m_h_r_1a100c1e31c0fbc8c8b292064c1a8da006" kindref="member">_THREE_CHAN_MODE</ref><sp/>&gt;<sp/>0);</highlight></codeline>
<codeline lineno="486"><highlight class="normal"><sp/><sp/><sp/><sp/>[</highlight><highlight class="keyword">self</highlight><highlight class="normal">.navigationController<sp/>pushViewController:settingsView<sp/>animated:YES];</highlight></codeline>
<codeline lineno="487"><highlight class="normal">}</highlight></codeline>
<codeline lineno="488"><highlight class="normal"></highlight></codeline>
<codeline lineno="489"><highlight class="normal"></highlight></codeline>
<codeline lineno="490"><highlight class="normal">-<sp/>(void)debugModeChanged:(BOOL)mode</highlight></codeline>
<codeline lineno="491"><highlight class="normal">{</highlight></codeline>
<codeline lineno="492"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="namespace_m_h_r_1a2446951af16ca1137edb21f8e07019cb" kindref="member">_DEBUG_MODE</ref><sp/>=<sp/>int(mode);</highlight></codeline>
<codeline lineno="493"><highlight class="normal">}</highlight></codeline>
<codeline lineno="494"><highlight class="normal"></highlight></codeline>
<codeline lineno="495"><highlight class="normal"></highlight></codeline>
<codeline lineno="496"><highlight class="normal">-<sp/>(void)threeChanModeChanged:(BOOL)mode</highlight></codeline>
<codeline lineno="497"><highlight class="normal">{</highlight></codeline>
<codeline lineno="498"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="namespace_m_h_r_1a100c1e31c0fbc8c8b292064c1a8da006" kindref="member">_THREE_CHAN_MODE</ref><sp/>=<sp/>int(mode);</highlight></codeline>
<codeline lineno="499"><highlight class="normal">}</highlight></codeline>
<codeline lineno="500"><highlight class="normal"></highlight></codeline>
<codeline lineno="501"><highlight class="normal"></highlight></codeline>
<codeline lineno="502"><highlight class="normal"></highlight><highlight class="keyword">@end</highlight><highlight class="normal"></highlight></codeline>
    </programlisting>
    <location file="/Users/misfit/Desktop/Codes - Github-linked/videoHeartRate/MisfitHeartRate/MisfitHeartRate/MainView/MHRMainViewController.mm"/>
  </compounddef>
</doxygen>
